# Базовые понимания о разработке системы

+ Особенности голосования
  + Никакого блокчейна, считаем его "overengineering"
  + Частичное шгомоморфное шифрование бюллетени (Система Пайе) с подсчетом результатов только в процессе "Подсчета голосов"
      + Как делать переголосование?
        + После отправки бюллетеня придется оставлять на клиентской стороне какой-то остаток или слепок бюллетени, чтобы был вариант ZKP на наличие бюллетеня от этого пользователя
        + "Публикация тега "убитой бюллетени"
  + Слепые подписи Регистратором уже сгенерированной бюллетени
  + ZKP для подтверждения соответствия бюллетени ОДНОЙ ИЗ вариаций бюллетени
    + Схема Fiat-Shamir
      + Генерируем подтверждение формата бюллетени, а для остальных вариаций генерируем "фиктивные доказательства"
      + Проверяющий (Счетчик и Регистратор) проверяют доказательство форматом OR
  + Проверка того, что голоса учтены в процессе голосования
    + Система постоянно будет генерировать Merklie-дерево на основе всех активных бюллетеней и отдавать получаемый хеш корня дерева в открытом виде.
    + Каждый сможет скачать пулл зашифрованных бюллетеней и вычислить Merkile-дерево самостоятельно, сверившись с данными корня
      + А также найти данные своей бюллетени внутри дерева
    + Вычисление результатов голосования будет происходить не по базе данных бюллетеней, а по данным в Merklie-дереве
      + И как это подтвердить?
        + Публикуем Merklie-дерево
        + Вычисляем зашифрованную сумму
          + Механизм вычисления делать на основе Merklie-дерева
        + Публикуем зашифрованную сумму
        + Публикуем результат вычислений
        + Предполагается использование ZKP на подтверждение правильного вычисления



+ Компоненты системы
	+ Аутентификатор
    	+ Получает от администраторов голосования список пользователей в формате "Имя - Фамилия - Отчество"
        	+ Это простейший формат подтверждения личности,но это будет "пока"
      	+ Отдает пользователям токены доступа (JWT?) и данные Регистратора для генерации бюллетени и всех подтверждений, если пользователь подтвердил свою личность (пока просто вписал свои имя-фамилия-отчество)
        	+ Данные криптосхемы Пайе
        	+ Размер окна опции варианта и количество вариантов
        	+ Ключи для генерации слепой подписи
        	+ Правила генерации ZKP
	+ Регистратор
		+ Получает бюллетень пользователя
			+ Сверяет идентификатор со списокм
			+ Проверяет валидность ZKP
			+ Если всё хорошо, слепо подписывает бюллетень и отдает подпись пользователю
	+ Счетчик
		+ Получает бюллетень от пользователя с ZKP, гомоморфным шифрованием и *слепой подписью* от Регистратора
		+ Публикует все получаемые теги и зашифрованные бюллетени в открытом реестре
  		+ Обновляет Меркли-дерево и перепубликует корень
  		+ По окончании процесса получения бюллетеней - собирает данные из Меркли-дерева и полноценно высчитывает результаты, применяя закрытый ключ
    		+ А затем публикует результаты голосования и итоговую зашифрованную сумму


+ Описание инструментов
	+ Используемый фреймворк - Drogon C++
	+ Базы данных
		+ PG для хранения полученных данных и списка избирателей
		+ Redis для хранения токенов доступа пользователей
		+ Нужно поискать метод хранения дерева Меркли так, чтобы его было удобно генерировать из БД
    		+ Такой БД не найдено, отдыхаем


+ Какие страницы нужны
  + Страница входа 
    + Ввод "логина" и "пароля"
    + Должна дополнительно вернуть токен доступа пользователю, а также все парамтеры генерации подписей и шифрования
  + Личный кабинет
    + Пишет, под каким аккаунтом произведен вход
    + С данных пользователя получает информацию о том, голосовал человек или нет, а также показывает хэш сгенерированной бюллетени после голосования
  + Активные голосования
    + Сюда можно получить доступ из личного кабинета
    + Показывает список активных голосований 
  + Страница голосования
    + Выводится вопрос голосования и варианты ответа
    + Под капотом генерируются нужные данные и отправляются в соответствии с протоколом голосования
  + Если голосование уже произведено, есть возможность переголосовать - так же откроется страница голосования
  + Страница реестров
    + Туда выводятся:
      + Реестр Меркли-дерева + Корень
  + Страница проверки учета голосов
    + Проверка осуществляется через Мerklie-дерево
  + Страница публикации результатов голосования


+ Чего не хватает на данный момент
  + Мне нужна реализация Merklie-дерева, которую можно будет записывать в файл для отправки, а также на основе которого можно будет генерировать доказательство наличия в дереве определенного бюллетеня.
  + Конечно, в это дерево я должен мочь добавлять очередную бюллетень с перегенерацией до корня, а также мочь убирать одну из бюллетеней, если пользователь посчитал нужным переголосовать. При переголосовании пользователь должен отдавать хеш своей зарегистрированной бюллетени, соответственно при удалении нужно пройтись по дереву и удалить бюллетень, соответствующую хешу
  + 